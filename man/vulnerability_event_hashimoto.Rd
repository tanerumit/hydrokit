% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wres_metrics.R
\name{vulnerability_event_hashimoto}
\alias{vulnerability_event_hashimoto}
\title{Hashimoto vulnerability (event-based)}
\usage{
vulnerability_event_hashimoto(
  obs_threshold,
  sim_supply,
  event_stat = c("sum", "mean", "max"),
  event_agg = c("mean", "median", "max"),
  na_action = c("omit", "fail"),
  no_failure = c("na", "zero"),
  return_components = FALSE
)
}
\arguments{
\item{obs_threshold}{Numeric vector. Threshold per timestep (same units as supply).}

\item{sim_supply}{Numeric vector. Supply per timestep.}

\item{event_stat}{Character scalar: "sum", "mean", or "max" severity per event.}

\item{event_agg}{Character scalar: "mean", "median", or "max" aggregation across events.}

\item{na_action}{Character scalar: "omit" (drop non-finite pairs) or "fail" (error).}

\item{no_failure}{Character scalar: value if there are no failure events: "na" (default), "zero".}

\item{return_components}{Logical. If TRUE, return diagnostics including per-event severities.}
}
\value{
If \code{return_components = FALSE}, numeric scalar vulnerability (units depend on \code{event_stat}).
If \code{return_components = TRUE}, a list with:
\itemize{
\item \code{vulnerability} numeric scalar,
\item \code{n_events} integer,
\item \code{event_values} numeric vector (per-event severities),
\item \code{event_lengths} integer vector (timesteps per event),
\item \code{n_dropped} integer (timesteps dropped due to NA handling).
}
}
\description{
Computes event-based vulnerability by identifying contiguous failure events
(runs where \code{sim_supply < obs_threshold}) and computing a severity statistic
per event from deficit magnitudes. The returned vulnerability is then a summary
across events.
}
\details{
Failure event: contiguous timesteps with \code{sim_supply < obs_threshold}.
Deficit magnitude: \code{max(obs_threshold - sim_supply, 0)}.

Event severity (\code{event_stat}):
\itemize{
\item "sum": integrated deficit over the event (units: supply * timestep)
\item "mean": mean deficit magnitude during the event (units: supply)
\item "max": maximum deficit magnitude during the event (units: supply)
}

Across-event aggregation (\code{event_agg}):
\itemize{
\item "mean" (default), "median", "max"
}

Edge cases:
\itemize{
\item If there are no failure events, return value controlled by \code{no_failure}.
\item Non-finite values handled via \code{na_action} (consistent with other metrics).
}
}
\examples{
obs_threshold <- rep(10, 8)
sim_supply <- c(12, 8, 7, 11, 9, 8, 10, 12)
vulnerability_event_hashimoto(obs_threshold, sim_supply, event_stat = "sum")
}
